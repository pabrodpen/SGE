CREATE TABLE sale_order (id SERIAL NOT NULL, campaign_id INTEGER, source_id INTEGER, medium_id INTEGER, message_main_attachment_id INTEGER, access_token CHARACTER VARYING, name CHARACTER VARYING NOT NULL, origin CHARACTER VARYING, client_order_ref CHARACTER VARYING, reference CHARACTER VARYING, state CHARACTER VARYING, date_order TIMESTAMP(6) WITHOUT TIME ZONE NOT NULL, validity_date DATE, require_signature BOOLEAN, require_payment BOOLEAN, create_date TIMESTAMP(6) WITHOUT TIME ZONE, user_id INTEGER, partner_id INTEGER NOT NULL, partner_invoice_id INTEGER NOT NULL, partner_shipping_id INTEGER NOT NULL, pricelist_id INTEGER NOT NULL, currency_id INTEGER, analytic_account_id INTEGER, invoice_status CHARACTER VARYING, note TEXT, amount_untaxed NUMERIC, amount_tax NUMERIC, amount_total NUMERIC, currency_rate NUMERIC, payment_term_id INTEGER, fiscal_position_id INTEGER, company_id INTEGER NOT NULL, team_id INTEGER, signed_by CHARACTER VARYING, signed_on TIMESTAMP(6) WITHOUT TIME ZONE, commitment_date TIMESTAMP(6) WITHOUT TIME ZONE, show_update_pricelist BOOLEAN, create_uid INTEGER, write_uid INTEGER, write_date TIMESTAMP(6) WITHOUT TIME ZONE, sale_order_template_id INTEGER, incoterm INTEGER, picking_policy CHARACTER VARYING NOT NULL, warehouse_id INTEGER NOT NULL, procurement_group_id INTEGER, effective_date TIMESTAMP(6) WITHOUT TIME ZONE, PRIMARY KEY (id), CONSTRAINT sale_order_analytic_account_id_fkey FOREIGN KEY (analytic_account_id) REFERENCES "account_analytic_account" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_campaign_id_fkey FOREIGN KEY (campaign_id) REFERENCES "utm_campaign" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_company_id_fkey FOREIGN KEY (company_id) REFERENCES "res_company" ("id") ON DELETE RESTRICT, CONSTRAINT sale_order_create_uid_fkey FOREIGN KEY (create_uid) REFERENCES "res_users" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_currency_id_fkey FOREIGN KEY (currency_id) REFERENCES "res_currency" ("id") ON DELETE RESTRICT, CONSTRAINT sale_order_fiscal_position_id_fkey FOREIGN KEY (fiscal_position_id) REFERENCES "account_fiscal_position" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_incoterm_fkey FOREIGN KEY (incoterm) REFERENCES "account_incoterms" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_medium_id_fkey FOREIGN KEY (medium_id) REFERENCES "utm_medium" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_message_main_attachment_id_fkey FOREIGN KEY (message_main_attachment_id) REFERENCES "ir_attachment" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_partner_id_fkey FOREIGN KEY (partner_id) REFERENCES "res_partner" ("id") ON DELETE RESTRICT, CONSTRAINT sale_order_partner_invoice_id_fkey FOREIGN KEY (partner_invoice_id) REFERENCES "res_partner" ("id") ON DELETE RESTRICT, CONSTRAINT sale_order_partner_shipping_id_fkey FOREIGN KEY (partner_shipping_id) REFERENCES "res_partner" ("id") ON DELETE RESTRICT, CONSTRAINT sale_order_payment_term_id_fkey FOREIGN KEY (payment_term_id) REFERENCES "account_payment_term" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_pricelist_id_fkey FOREIGN KEY (pricelist_id) REFERENCES "product_pricelist" ("id") ON DELETE RESTRICT, CONSTRAINT sale_order_procurement_group_id_fkey FOREIGN KEY (procurement_group_id) REFERENCES "procurement_group" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_sale_order_template_id_fkey FOREIGN KEY (sale_order_template_id) REFERENCES "sale_order_template" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_source_id_fkey FOREIGN KEY (source_id) REFERENCES "utm_source" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_team_id_fkey FOREIGN KEY (team_id) REFERENCES "crm_team" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_user_id_fkey FOREIGN KEY (user_id) REFERENCES "res_users" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_warehouse_id_fkey FOREIGN KEY (warehouse_id) REFERENCES "stock_warehouse" ("id") ON DELETE RESTRICT, CONSTRAINT sale_order_write_uid_fkey FOREIGN KEY (write_uid) REFERENCES "res_users" ("id") ON DELETE SET NULL, CONSTRAINT sale_order_date_order_conditional_required CHECK (((state)::text = ANY ((ARRAY['sale'::character varying, 'done'::character varying])::text[])) AND (date_order IS NOT NULL)) OR ((state)::text <> ALL ((ARRAY['sale'::character varying, 'done'::character varying])::text[])));
COMMENT ON TABLE sale_order IS 'Sales Order';
COMMENT ON COLUMN sale_order.campaign_id IS 'Campaign';
COMMENT ON COLUMN sale_order.source_id IS 'Source';
COMMENT ON COLUMN sale_order.medium_id IS 'Medium';
COMMENT ON COLUMN sale_order.message_main_attachment_id IS 'Main Attachment';
COMMENT ON COLUMN sale_order.access_token IS 'Security Token';
COMMENT ON COLUMN sale_order.name IS 'Order Reference';
COMMENT ON COLUMN sale_order.origin IS 'Source Document';
COMMENT ON COLUMN sale_order.client_order_ref IS 'Customer Reference';
COMMENT ON COLUMN sale_order.reference IS 'Payment Ref.';
COMMENT ON COLUMN sale_order.state IS 'Status';
COMMENT ON COLUMN sale_order.date_order IS 'Order Date';
COMMENT ON COLUMN sale_order.validity_date IS 'Expiration';
COMMENT ON COLUMN sale_order.require_signature IS 'Online Signature';
COMMENT ON COLUMN sale_order.require_payment IS 'Online Payment';
COMMENT ON COLUMN sale_order.create_date IS 'Creation Date';
COMMENT ON COLUMN sale_order.user_id IS 'Salesperson';
COMMENT ON COLUMN sale_order.partner_id IS 'Customer';
COMMENT ON COLUMN sale_order.partner_invoice_id IS 'Invoice Address';
COMMENT ON COLUMN sale_order.partner_shipping_id IS 'Delivery Address';
COMMENT ON COLUMN sale_order.pricelist_id IS 'Pricelist';
COMMENT ON COLUMN sale_order.currency_id IS 'Currency';
COMMENT ON COLUMN sale_order.analytic_account_id IS 'Analytic Account';
COMMENT ON COLUMN sale_order.invoice_status IS 'Invoice Status';
COMMENT ON COLUMN sale_order.note IS 'Terms and conditions';
COMMENT ON COLUMN sale_order.amount_untaxed IS 'Untaxed Amount';
COMMENT ON COLUMN sale_order.amount_tax IS 'Taxes';
COMMENT ON COLUMN sale_order.amount_total IS 'Total';
COMMENT ON COLUMN sale_order.currency_rate IS 'Currency Rate';
COMMENT ON COLUMN sale_order.payment_term_id IS 'Payment Terms';
COMMENT ON COLUMN sale_order.fiscal_position_id IS 'Fiscal Position';
COMMENT ON COLUMN sale_order.company_id IS 'Company';
COMMENT ON COLUMN sale_order.team_id IS 'Sales Team';
COMMENT ON COLUMN sale_order.signed_by IS 'Signed By';
COMMENT ON COLUMN sale_order.signed_on IS 'Signed On';
COMMENT ON COLUMN sale_order.commitment_date IS 'Delivery Date';
COMMENT ON COLUMN sale_order.show_update_pricelist IS 'Has Pricelist Changed';
COMMENT ON COLUMN sale_order.create_uid IS 'Created by';
COMMENT ON COLUMN sale_order.write_uid IS 'Last Updated by';
COMMENT ON COLUMN sale_order.write_date IS 'Last Updated on';
COMMENT ON COLUMN sale_order.sale_order_template_id IS 'Quotation Template';
COMMENT ON COLUMN sale_order.incoterm IS 'Incoterm';
COMMENT ON COLUMN sale_order.picking_policy IS 'Shipping Policy';
COMMENT ON COLUMN sale_order.warehouse_id IS 'Warehouse';
COMMENT ON COLUMN sale_order.procurement_group_id IS 'Procurement Group';
COMMENT ON COLUMN sale_order.effective_date IS 'Effective Date';
COMMENT ON CONSTRAINT sale_order_date_order_conditional_required ON sale_order IS 'CHECK( (state IN ('sale', 'done') AND date_order IS NOT NULL) OR state NOT IN ('sale', 'done') )';
